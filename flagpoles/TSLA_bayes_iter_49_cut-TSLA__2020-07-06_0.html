<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flagpole Analysis - TSLA - cut-TSLA, 2020-07-06 | Professional Trading Analytics</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/styles.css">
    <script src="https://unpkg.com/lightweight-charts@4.1.0/dist/lightweight-charts.standalone.production.js"></script>
</head>
<body>
    <div class="container">
        <nav class="breadcrumb">
            <a href="../index.html">Home</a> /
            <a href="../experiments/TSLA_bayes_iter_49.html">
                TSLA - bayes_iter_49
            </a> /
            <span>Flagpole Details</span>
        </nav>

        
        <nav class="flagpole-navigation">
            <div class="nav-container">
                <a href="TSLA_bayes_iter_49_cut-TSLA__2020-06-30_0.html" class="nav-btn prev-btn">← Previous</a>
                <span class="nav-info">
                    Flagpole 193 of 426
                </span>
                <a href="TSLA_bayes_iter_49_cut-TSLA__2020-07-10_0.html" class="nav-btn next-btn">Next →</a>
            </div>
            <div class="nav-experiment-link">
                <a href="../experiments/TSLA_bayes_iter_49.html" class="nav-btn experiment-btn">
                    ← Back to TSLA - bayes_iter_49
                </a>
            </div>
        </nav>
        

        <header>
            <div class="flagpole-header-info">
                <span class="ticker">TSLA</span>
                <span class="timestamp">cut-TSLA, 2020-07-06</span>
            </div>
        </header>

        <div class="flagpole-content">
            <div class="section">
                <h2>Flagpole Information</h2>
                <div id="chart" style="height: 660px; width: 100%; background: #0B1426; border: 2px solid #00D4A3; padding: 0; box-sizing: border-box; overflow: visible; border-radius: 8px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3); margin: 0; display: block; position: relative;"></div>
            </div>
            
            
<script>
// Chart initialization for flagpole visualization
(function() {
    'use strict';
    
    // Configuration
    const chartOptions = {"height": 640, "layout": {"backgroundColor": "#0B1426", "textColor": "#F8FAFC", "fontSize": 14, "fontFamily": "'JetBrains Mono', 'SF Mono', 'Monaco', 'Consolas', monospace"}, "grid": {"vertLines": {"color": "#2D3748", "style": 0, "visible": true}, "horzLines": {"color": "#2D3748", "style": 0, "visible": true}}, "timeScale": {"visible": true, "borderVisible": true, "borderColor": "#334155", "timeVisible": true, "secondsVisible": false, "tickMarkColor": "#F8FAFC", "rightBarStaysOnScroll": true, "fixLeftEdge": false, "fixRightEdge": false, "ticksVisible": true, "minBarSpacing": 1.0, "barSpacing": 8, "height": 40}, "rightPriceScale": {"visible": true, "borderVisible": true, "borderColor": "#334155", "ticksVisible": true, "scaleMargins": {"top": 0.1, "bottom": 0.2}}, "crosshair": {"mode": 0, "vertLine": {"visible": true, "labelVisible": true}, "horzLine": {"visible": true, "labelVisible": true}}, "localization": {"locale": "en-US", "dateFormat": "yyyy-MM-dd"}};
    const candlestickData = [{"time": "2020-07-06 13:30:00", "open": 85.1127, "high": 85.198, "low": 84.7333, "close": 84.8227, "volume": 4308240.0}, {"time": "2020-07-06 13:31:00", "open": 84.792, "high": 85.0693, "low": 84.4029, "close": 84.6353, "volume": 1973265.0}, {"time": "2020-07-06 13:32:00", "open": 84.6047, "high": 85.5333, "low": 84.6047, "close": 85.4233, "volume": 2742855.0}, {"time": "2020-07-06 13:33:00", "open": 85.4057, "high": 85.618, "low": 85.1633, "close": 85.258, "volume": 2296140.0}, {"time": "2020-07-06 13:34:00", "open": 85.228, "high": 85.53, "low": 85.1513, "close": 85.4473, "volume": 1395795.0}, {"time": "2020-07-06 13:35:00", "open": 85.4272, "high": 85.4965, "low": 85.0693, "close": 85.0693, "volume": 1316745.0}, {"time": "2020-07-06 13:36:00", "open": 85.0513, "high": 85.1916, "low": 84.8087, "close": 85.044, "volume": 1496085.0}, {"time": "2020-07-06 13:37:00", "open": 85.0067, "high": 85.082, "low": 84.8607, "close": 84.9675, "volume": 1033485.0}, {"time": "2020-07-06 13:38:00", "open": 85.0213, "high": 85.266, "low": 84.9486, "close": 85.2063, "volume": 1302705.0}, {"time": "2020-07-06 13:39:00", "open": 85.1633, "high": 85.2273, "low": 84.8853, "close": 84.9993, "volume": 961650.0}, {"time": "2020-07-06 13:40:00", "open": 85.012, "high": 85.0993, "low": 84.6667, "close": 85.0453, "volume": 1638285.0}, {"time": "2020-07-06 13:41:00", "open": 85.0233, "high": 85.2416, "low": 84.869, "close": 85.1993, "volume": 949305.0}, {"time": "2020-07-06 13:42:00", "open": 85.1995, "high": 85.5113, "low": 85.0727, "close": 85.5113, "volume": 1644345.0}, {"time": "2020-07-06 13:43:00", "open": 85.49, "high": 85.8433, "low": 85.4007, "close": 85.775, "volume": 2087190.0}, {"time": "2020-07-06 13:44:00", "open": 85.7727, "high": 86.2667, "low": 85.7447, "close": 86.1693, "volume": 2542485.0}, {"time": "2020-07-06 13:45:00", "open": 86.1963, "high": 86.5333, "low": 86.016, "close": 86.1547, "volume": 2415765.0}, {"time": "2020-07-06 13:46:00", "open": 86.1947, "high": 86.4807, "low": 86.07, "close": 86.3693, "volume": 1673685.0}, {"time": "2020-07-06 13:47:00", "open": 86.3713, "high": 86.3907, "low": 85.89, "close": 86.106, "volume": 1455045.0}, {"time": "2020-07-06 13:48:00", "open": 86.0937, "high": 86.2167, "low": 85.926, "close": 86.178, "volume": 1114695.0}, {"time": "2020-07-06 13:49:00", "open": 86.1865, "high": 86.3027, "low": 86.0333, "close": 86.2, "volume": 1034625.0}, {"time": "2020-07-06 13:50:00", "open": 86.232, "high": 86.28, "low": 85.9941, "close": 86.1553, "volume": 940905.0}, {"time": "2020-07-06 13:51:00", "open": 86.1773, "high": 86.3767, "low": 85.8273, "close": 85.8273, "volume": 1535595.0}, {"time": "2020-07-06 13:52:00", "open": 85.8502, "high": 86.0867, "low": 85.778, "close": 86.017, "volume": 827625.0}, {"time": "2020-07-06 13:53:00", "open": 86.021, "high": 86.2127, "low": 85.9173, "close": 86.1873, "volume": 966030.0}, {"time": "2020-07-06 13:54:00", "open": 86.1923, "high": 86.5293, "low": 86.1473, "close": 86.5097, "volume": 1417230.0}, {"time": "2020-07-06 13:55:00", "open": 86.4997, "high": 86.642, "low": 86.2867, "close": 86.5426, "volume": 1725315.0}, {"time": "2020-07-06 13:56:00", "open": 86.5727, "high": 86.5933, "low": 86.3887, "close": 86.586, "volume": 957030.0}, {"time": "2020-07-06 13:57:00", "open": 86.538, "high": 86.622, "low": 86.378, "close": 86.4687, "volume": 897195.0}, {"time": "2020-07-06 13:58:00", "open": 86.4467, "high": 86.5353, "low": 86.3374, "close": 86.3793, "volume": 767415.0}, {"time": "2020-07-06 13:59:00", "open": 86.3969, "high": 86.9333, "low": 86.366, "close": 86.8597, "volume": 2463645.0}, {"time": "2020-07-06 14:00:00", "open": 86.9267, "high": 87.0721, "low": 86.6667, "close": 86.924, "volume": 1684590.0}, {"time": "2020-07-06 14:01:00", "open": 86.8728, "high": 87.1773, "low": 86.8728, "close": 87.0504, "volume": 1519335.0}, {"time": "2020-07-06 14:02:00", "open": 87.03, "high": 87.2293, "low": 86.828, "close": 87.0407, "volume": 1612665.0}, {"time": "2020-07-06 14:03:00", "open": 87.0527, "high": 87.2293, "low": 86.9587, "close": 87.1449, "volume": 1034925.0}, {"time": "2020-07-06 14:04:00", "open": 87.134, "high": 87.2262, "low": 86.9474, "close": 87.128, "volume": 1078140.0}, {"time": "2020-07-06 14:05:00", "open": 87.1107, "high": 87.3167, "low": 86.908, "close": 86.908, "volume": 1575660.0}, {"time": "2020-07-06 14:06:00", "open": 86.8867, "high": 87.1327, "low": 86.7487, "close": 86.7873, "volume": 1370835.0}, {"time": "2020-07-06 14:07:00", "open": 86.7683, "high": 87.0, "low": 86.5387, "close": 86.9627, "volume": 1464585.0}, {"time": "2020-07-06 14:08:00", "open": 86.9053, "high": 87.024, "low": 86.8, "close": 86.9207, "volume": 877575.0}, {"time": "2020-07-06 14:09:00", "open": 86.9315, "high": 86.9987, "low": 86.7687, "close": 86.7807, "volume": 578295.0}, {"time": "2020-07-06 14:10:00", "open": 86.78, "high": 86.988, "low": 86.754, "close": 86.9076, "volume": 621150.0}, {"time": "2020-07-06 14:11:00", "open": 86.9007, "high": 87.0633, "low": 86.6333, "close": 86.6667, "volume": 1239030.0}, {"time": "2020-07-06 14:12:00", "open": 86.6333, "high": 86.7, "low": 86.4713, "close": 86.5415, "volume": 1082715.0}, {"time": "2020-07-06 14:13:00", "open": 86.5997, "high": 86.6907, "low": 86.4667, "close": 86.6737, "volume": 764715.0}, {"time": "2020-07-06 14:14:00", "open": 86.6667, "high": 86.772, "low": 86.552, "close": 86.648, "volume": 655305.0}, {"time": "2020-07-06 14:15:00", "open": 86.6858, "high": 86.826, "low": 86.604, "close": 86.648, "volume": 731715.0}, {"time": "2020-07-06 14:16:00", "open": 86.6294, "high": 86.716, "low": 86.5207, "close": 86.636, "volume": 584115.0}, {"time": "2020-07-06 14:17:00", "open": 86.6227, "high": 86.6533, "low": 86.434, "close": 86.6302, "volume": 480525.0}, {"time": "2020-07-06 14:18:00", "open": 86.6647, "high": 86.7, "low": 86.3847, "close": 86.4687, "volume": 801120.0}, {"time": "2020-07-06 14:19:00", "open": 86.4847, "high": 86.52, "low": 86.2667, "close": 86.32, "volume": 751140.0}, {"time": "2020-07-06 14:20:00", "open": 86.33, "high": 86.3333, "low": 86.104, "close": 86.2207, "volume": 1026465.0}, {"time": "2020-07-06 14:21:00", "open": 86.1687, "high": 86.4333, "low": 86.1667, "close": 86.4013, "volume": 892080.0}, {"time": "2020-07-06 14:22:00", "open": 86.4333, "high": 86.6513, "low": 86.3087, "close": 86.6153, "volume": 824610.0}, {"time": "2020-07-06 14:23:00", "open": 86.5872, "high": 86.6333, "low": 86.452, "close": 86.4793, "volume": 571545.0}, {"time": "2020-07-06 14:24:00", "open": 86.4533, "high": 86.6587, "low": 86.3333, "close": 86.409, "volume": 555390.0}, {"time": "2020-07-06 14:25:00", "open": 86.3967, "high": 86.4733, "low": 86.3327, "close": 86.39, "volume": 336015.0}, {"time": "2020-07-06 14:26:00", "open": 86.4087, "high": 86.5853, "low": 86.3333, "close": 86.336, "volume": 501045.0}, {"time": "2020-07-06 14:27:00", "open": 86.365, "high": 86.5368, "low": 86.2667, "close": 86.49, "volume": 588255.0}, {"time": "2020-07-06 14:28:00", "open": 86.5067, "high": 86.6933, "low": 86.4834, "close": 86.5447, "volume": 916575.0}, {"time": "2020-07-06 14:29:00", "open": 86.5967, "high": 86.8667, "low": 86.535, "close": 86.8467, "volume": 950700.0}, {"time": "2020-07-06 14:30:00", "open": 86.8204, "high": 86.96, "low": 86.6973, "close": 86.8733, "volume": 795825.0}, {"time": "2020-07-06 14:31:00", "open": 86.8693, "high": 86.8693, "low": 86.652, "close": 86.7402, "volume": 543810.0}, {"time": "2020-07-06 14:32:00", "open": 86.8, "high": 86.83, "low": 86.674, "close": 86.8, "volume": 540900.0}, {"time": "2020-07-06 14:33:00", "open": 86.752, "high": 86.8253, "low": 86.5333, "close": 86.562, "volume": 608940.0}, {"time": "2020-07-06 14:34:00", "open": 86.5845, "high": 86.7733, "low": 86.5593, "close": 86.734, "volume": 399435.0}, {"time": "2020-07-06 14:35:00", "open": 86.74, "high": 86.7913, "low": 86.6373, "close": 86.7333, "volume": 353610.0}, {"time": "2020-07-06 14:36:00", "open": 86.7153, "high": 86.7153, "low": 86.5333, "close": 86.6273, "volume": 492000.0}, {"time": "2020-07-06 14:37:00", "open": 86.6228, "high": 86.68, "low": 86.554, "close": 86.6533, "volume": 385320.0}, {"time": "2020-07-06 14:38:00", "open": 86.6373, "high": 86.7333, "low": 86.5667, "close": 86.7187, "volume": 360270.0}, {"time": "2020-07-06 14:39:00", "open": 86.7133, "high": 86.7284, "low": 86.5333, "close": 86.6007, "volume": 387420.0}, {"time": "2020-07-06 14:40:00", "open": 86.6353, "high": 86.8, "low": 86.5333, "close": 86.756, "volume": 624135.0}, {"time": "2020-07-06 14:41:00", "open": 86.796, "high": 86.8666, "low": 86.6667, "close": 86.6993, "volume": 460980.0}, {"time": "2020-07-06 14:42:00", "open": 86.6497, "high": 86.7173, "low": 86.5667, "close": 86.5927, "volume": 369435.0}, {"time": "2020-07-06 14:43:00", "open": 86.5693, "high": 86.7207, "low": 86.4993, "close": 86.668, "volume": 509955.0}, {"time": "2020-07-06 14:44:00", "open": 86.71, "high": 86.7933, "low": 86.6547, "close": 86.6776, "volume": 300120.0}, {"time": "2020-07-06 14:45:00", "open": 86.7093, "high": 86.8153, "low": 86.6387, "close": 86.7393, "volume": 470085.0}, {"time": "2020-07-06 14:46:00", "open": 86.768, "high": 86.8063, "low": 86.7153, "close": 86.8, "volume": 362010.0}, {"time": "2020-07-06 14:47:00", "open": 86.7733, "high": 86.8233, "low": 86.6333, "close": 86.7033, "volume": 426360.0}, {"time": "2020-07-06 14:48:00", "open": 86.7327, "high": 86.782, "low": 86.7, "close": 86.742, "volume": 216390.0}, {"time": "2020-07-06 14:49:00", "open": 86.7693, "high": 86.832, "low": 86.744, "close": 86.796, "volume": 483000.0}, {"time": "2020-07-06 14:50:00", "open": 86.788, "high": 86.8793, "low": 86.58, "close": 86.654, "volume": 616665.0}, {"time": "2020-07-06 14:51:00", "open": 86.6607, "high": 86.8113, "low": 86.6607, "close": 86.7947, "volume": 303105.0}, {"time": "2020-07-06 14:52:00", "open": 86.784, "high": 86.8187, "low": 86.695, "close": 86.762, "volume": 296955.0}, {"time": "2020-07-06 14:53:00", "open": 86.7507, "high": 86.814, "low": 86.7107, "close": 86.7547, "volume": 244350.0}, {"time": "2020-07-06 14:54:00", "open": 86.808, "high": 86.8707, "low": 86.6733, "close": 86.773, "volume": 422130.0}, {"time": "2020-07-06 14:55:00", "open": 86.764, "high": 86.8291, "low": 86.764, "close": 86.7923, "volume": 207825.0}, {"time": "2020-07-06 14:56:00", "open": 86.811, "high": 86.8133, "low": 86.7275, "close": 86.7633, "volume": 221730.0}, {"time": "2020-07-06 14:57:00", "open": 86.7647, "high": 87.1, "low": 86.7647, "close": 87.024, "volume": 1138380.0}, {"time": "2020-07-06 14:58:00", "open": 87.0273, "high": 87.1927, "low": 87.0273, "close": 87.054, "volume": 1268700.0}, {"time": "2020-07-06 14:59:00", "open": 87.078, "high": 87.166, "low": 86.9793, "close": 87.1407, "volume": 617220.0}, {"time": "2020-07-06 15:00:00", "open": 87.1753, "high": 87.51, "low": 87.08, "close": 87.376, "volume": 1741965.0}, {"time": "2020-07-06 15:01:00", "open": 87.386, "high": 87.6127, "low": 87.3347, "close": 87.4993, "volume": 1254555.0}, {"time": "2020-07-06 15:02:00", "open": 87.5042, "high": 87.5482, "low": 87.386, "close": 87.4667, "volume": 975990.0}, {"time": "2020-07-06 15:03:00", "open": 87.4667, "high": 87.6, "low": 87.4207, "close": 87.5952, "volume": 647955.0}, {"time": "2020-07-06 15:04:00", "open": 87.6103, "high": 87.7933, "low": 87.5333, "close": 87.7418, "volume": 1312785.0}, {"time": "2020-07-06 15:05:00", "open": 87.723, "high": 87.7684, "low": 87.4886, "close": 87.5563, "volume": 982380.0}, {"time": "2020-07-06 15:06:00", "open": 87.594, "high": 87.7307, "low": 87.5533, "close": 87.672, "volume": 695340.0}, {"time": "2020-07-06 15:07:00", "open": 87.6913, "high": 87.7333, "low": 87.58, "close": 87.624, "volume": 574740.0}, {"time": "2020-07-06 15:08:00", "open": 87.62, "high": 87.6953, "low": 87.5387, "close": 87.5804, "volume": 565815.0}, {"time": "2020-07-06 15:09:00", "open": 87.5827, "high": 87.8667, "low": 87.5423, "close": 87.8257, "volume": 1121400.0}, {"time": "2020-07-06 15:10:00", "open": 87.79, "high": 87.9333, "low": 87.6667, "close": 87.798, "volume": 1317735.0}, {"time": "2020-07-06 15:11:00", "open": 87.7653, "high": 87.8033, "low": 87.6067, "close": 87.7047, "volume": 783570.0}, {"time": "2020-07-06 15:12:00", "open": 87.7067, "high": 87.79, "low": 87.4867, "close": 87.5567, "volume": 774135.0}, {"time": "2020-07-06 15:13:00", "open": 87.614, "high": 87.6505, "low": 87.5, "close": 87.51, "volume": 581520.0}, {"time": "2020-07-06 15:14:00", "open": 87.516, "high": 87.632, "low": 87.4667, "close": 87.5667, "volume": 563760.0}, {"time": "2020-07-06 15:15:00", "open": 87.5686, "high": 87.642, "low": 87.4667, "close": 87.6033, "volume": 560070.0}, {"time": "2020-07-06 15:16:00", "open": 87.5847, "high": 87.7167, "low": 87.5733, "close": 87.5867, "volume": 516960.0}, {"time": "2020-07-06 15:17:00", "open": 87.6367, "high": 87.7, "low": 87.5827, "close": 87.7, "volume": 621630.0}, {"time": "2020-07-06 15:18:00", "open": 87.6907, "high": 87.7333, "low": 87.534, "close": 87.6667, "volume": 457905.0}, {"time": "2020-07-06 15:19:00", "open": 87.662, "high": 87.7333, "low": 87.606, "close": 87.7179, "volume": 418035.0}, {"time": "2020-07-06 15:20:00", "open": 87.7127, "high": 87.766, "low": 87.6487, "close": 87.744, "volume": 436350.0}, {"time": "2020-07-06 15:21:00", "open": 87.7333, "high": 87.7509, "low": 87.6093, "close": 87.6747, "volume": 315195.0}, {"time": "2020-07-06 15:22:00", "open": 87.6687, "high": 87.8, "low": 87.6673, "close": 87.757, "volume": 439920.0}, {"time": "2020-07-06 15:23:00", "open": 87.75, "high": 87.8849, "low": 87.6247, "close": 87.8313, "volume": 652770.0}, {"time": "2020-07-06 15:24:00", "open": 87.8787, "high": 88.0627, "low": 87.8107, "close": 88.038, "volume": 895695.0}, {"time": "2020-07-06 15:25:00", "open": 88.0, "high": 88.256, "low": 88.0, "close": 88.1667, "volume": 1096545.0}, {"time": "2020-07-06 15:26:00", "open": 88.1726, "high": 88.316, "low": 88.1147, "close": 88.2963, "volume": 1103565.0}, {"time": "2020-07-06 15:27:00", "open": 88.2961, "high": 88.4, "low": 88.2213, "close": 88.3113, "volume": 1121325.0}, {"time": "2020-07-06 15:28:00", "open": 88.302, "high": 88.3773, "low": 88.264, "close": 88.3423, "volume": 894165.0}, {"time": "2020-07-06 15:29:00", "open": 88.3247, "high": 88.326, "low": 88.142, "close": 88.173, "volume": 773010.0}, {"time": "2020-07-06 15:30:00", "open": 88.1829, "high": 88.3333, "low": 88.1187, "close": 88.1983, "volume": 906750.0}, {"time": "2020-07-06 15:31:00", "open": 88.2107, "high": 88.3333, "low": 88.1853, "close": 88.2373, "volume": 748350.0}, {"time": "2020-07-06 15:32:00", "open": 88.276, "high": 88.4927, "low": 88.276, "close": 88.4393, "volume": 935520.0}, {"time": "2020-07-06 15:33:00", "open": 88.426, "high": 88.5333, "low": 88.3833, "close": 88.47, "volume": 953145.0}, {"time": "2020-07-06 15:34:00", "open": 88.48, "high": 88.5467, "low": 88.41, "close": 88.4667, "volume": 677295.0}, {"time": "2020-07-06 15:35:00", "open": 88.4953, "high": 88.8393, "low": 88.4933, "close": 88.8393, "volume": 1645470.0}, {"time": "2020-07-06 15:36:00", "open": 88.854, "high": 89.0667, "low": 88.6967, "close": 88.9187, "volume": 1597365.0}, {"time": "2020-07-06 15:37:00", "open": 88.8977, "high": 89.1333, "low": 88.834, "close": 89.0597, "volume": 1253160.0}, {"time": "2020-07-06 15:38:00", "open": 89.062, "high": 89.228, "low": 88.9807, "close": 89.1, "volume": 1219545.0}, {"time": "2020-07-06 15:39:00", "open": 89.1, "high": 89.1333, "low": 88.9193, "close": 89.029, "volume": 1488930.0}, {"time": "2020-07-06 15:40:00", "open": 89.016, "high": 89.314, "low": 89.0, "close": 89.2333, "volume": 1284300.0}, {"time": "2020-07-06 15:41:00", "open": 89.2333, "high": 89.3147, "low": 89.074, "close": 89.1167, "volume": 981045.0}, {"time": "2020-07-06 15:42:00", "open": 89.1387, "high": 89.1545, "low": 88.9357, "close": 89.0433, "volume": 984225.0}, {"time": "2020-07-06 15:43:00", "open": 89.0773, "high": 89.4273, "low": 88.978, "close": 89.4253, "volume": 1523010.0}, {"time": "2020-07-06 15:44:00", "open": 89.4199, "high": 89.4667, "low": 89.2073, "close": 89.2737, "volume": 1344945.0}, {"time": "2020-07-06 15:45:00", "open": 89.2747, "high": 89.4227, "low": 89.242, "close": 89.312, "volume": 743340.0}, {"time": "2020-07-06 15:46:00", "open": 89.2962, "high": 89.421, "low": 89.1347, "close": 89.1673, "volume": 1201620.0}, {"time": "2020-07-06 15:47:00", "open": 89.174, "high": 89.199, "low": 89.0787, "close": 89.108, "volume": 871515.0}, {"time": "2020-07-06 15:48:00", "open": 89.1313, "high": 89.1987, "low": 89.0033, "close": 89.1407, "volume": 669000.0}, {"time": "2020-07-06 15:49:00", "open": 89.122, "high": 89.122, "low": 88.7673, "close": 88.7673, "volume": 1146435.0}, {"time": "2020-07-06 15:50:00", "open": 88.7947, "high": 88.7947, "low": 88.4513, "close": 88.596, "volume": 2069865.0}, {"time": "2020-07-06 15:51:00", "open": 88.6033, "high": 88.8667, "low": 88.6033, "close": 88.7607, "volume": 1051890.0}, {"time": "2020-07-06 15:52:00", "open": 88.8027, "high": 88.814, "low": 88.6957, "close": 88.7493, "volume": 431250.0}, {"time": "2020-07-06 15:53:00", "open": 88.7747, "high": 88.8, "low": 88.624, "close": 88.7327, "volume": 553965.0}, {"time": "2020-07-06 15:54:00", "open": 88.7547, "high": 88.8, "low": 88.692, "close": 88.7347, "volume": 474075.0}, {"time": "2020-07-06 15:55:00", "open": 88.7373, "high": 88.7613, "low": 88.4507, "close": 88.4763, "volume": 760950.0}, {"time": "2020-07-06 15:56:00", "open": 88.4813, "high": 88.572, "low": 88.4, "close": 88.5473, "volume": 593490.0}, {"time": "2020-07-06 15:57:00", "open": 88.566, "high": 88.7253, "low": 88.5253, "close": 88.5606, "volume": 578175.0}, {"time": "2020-07-06 15:58:00", "open": 88.5857, "high": 88.7033, "low": 88.526, "close": 88.536, "volume": 454830.0}, {"time": "2020-07-06 15:59:00", "open": 88.5747, "high": 88.5987, "low": 88.4, "close": 88.438, "volume": 677970.0}, {"time": "2020-07-06 16:00:00", "open": 88.4167, "high": 88.614, "low": 88.2173, "close": 88.5467, "volume": 1454565.0}, {"time": "2020-07-06 16:01:00", "open": 88.588, "high": 88.6, "low": 88.4347, "close": 88.4347, "volume": 584100.0}, {"time": "2020-07-06 16:02:00", "open": 88.4567, "high": 88.6827, "low": 88.4033, "close": 88.6133, "volume": 689550.0}, {"time": "2020-07-06 16:03:00", "open": 88.608, "high": 88.6837, "low": 88.4667, "close": 88.6837, "volume": 440790.0}, {"time": "2020-07-06 16:04:00", "open": 88.668, "high": 88.7327, "low": 88.3407, "close": 88.4673, "volume": 1355790.0}, {"time": "2020-07-06 16:05:00", "open": 88.4667, "high": 88.5113, "low": 88.2993, "close": 88.3313, "volume": 490320.0}, {"time": "2020-07-06 16:06:00", "open": 88.3353, "high": 88.3353, "low": 88.0667, "close": 88.1653, "volume": 828465.0}, {"time": "2020-07-06 16:07:00", "open": 88.1847, "high": 88.3333, "low": 88.1847, "close": 88.2267, "volume": 445305.0}, {"time": "2020-07-06 16:08:00", "open": 88.225, "high": 88.2417, "low": 87.9407, "close": 88.032, "volume": 745185.0}, {"time": "2020-07-06 16:09:00", "open": 87.9947, "high": 88.1287, "low": 87.9633, "close": 88.08, "volume": 654795.0}, {"time": "2020-07-06 16:10:00", "open": 88.0807, "high": 88.0813, "low": 87.8667, "close": 87.9333, "volume": 676815.0}, {"time": "2020-07-06 16:11:00", "open": 87.9807, "high": 88.2667, "low": 87.9573, "close": 88.2393, "volume": 584520.0}, {"time": "2020-07-06 16:12:00", "open": 88.2233, "high": 88.3827, "low": 88.1647, "close": 88.3827, "volume": 664575.0}, {"time": "2020-07-06 16:13:00", "open": 88.3847, "high": 88.5767, "low": 88.3347, "close": 88.4787, "volume": 1510740.0}, {"time": "2020-07-06 16:14:00", "open": 88.476, "high": 88.592, "low": 88.3441, "close": 88.5647, "volume": 648930.0}, {"time": "2020-07-06 16:15:00", "open": 88.5613, "high": 88.66, "low": 88.5507, "close": 88.619, "volume": 570690.0}, {"time": "2020-07-06 16:16:00", "open": 88.6194, "high": 88.7, "low": 88.5, "close": 88.548, "volume": 687255.0}, {"time": "2020-07-06 16:17:00", "open": 88.536, "high": 88.5773, "low": 88.4, "close": 88.5647, "volume": 608640.0}, {"time": "2020-07-06 16:18:00", "open": 88.5373, "high": 88.6517, "low": 88.442, "close": 88.4526, "volume": 422970.0}, {"time": "2020-07-06 16:19:00", "open": 88.4467, "high": 88.5493, "low": 88.434, "close": 88.4907, "volume": 512220.0}, {"time": "2020-07-06 16:20:00", "open": 88.4957, "high": 88.64, "low": 88.4233, "close": 88.5207, "volume": 564090.0}, {"time": "2020-07-06 16:21:00", "open": 88.476, "high": 88.4907, "low": 88.304, "close": 88.3618, "volume": 476760.0}, {"time": "2020-07-06 16:22:00", "open": 88.3655, "high": 88.382, "low": 88.0033, "close": 88.0693, "volume": 856410.0}, {"time": "2020-07-06 16:23:00", "open": 88.094, "high": 88.2457, "low": 88.0667, "close": 88.2287, "volume": 686520.0}, {"time": "2020-07-06 16:24:00", "open": 88.1867, "high": 88.1973, "low": 88.0673, "close": 88.1427, "volume": 374580.0}, {"time": "2020-07-06 16:25:00", "open": 88.1605, "high": 88.422, "low": 88.1605, "close": 88.3667, "volume": 506385.0}, {"time": "2020-07-06 16:26:00", "open": 88.36, "high": 88.51, "low": 88.3533, "close": 88.4747, "volume": 367860.0}, {"time": "2020-07-06 16:27:00", "open": 88.489, "high": 88.5133, "low": 88.3407, "close": 88.51, "volume": 333690.0}, {"time": "2020-07-06 16:28:00", "open": 88.492, "high": 88.6343, "low": 88.4713, "close": 88.6283, "volume": 487260.0}, {"time": "2020-07-06 16:29:00", "open": 88.6217, "high": 88.8667, "low": 88.4727, "close": 88.7585, "volume": 1090305.0}, {"time": "2020-07-06 16:30:00", "open": 88.7563, "high": 88.8653, "low": 88.6567, "close": 88.7973, "volume": 656190.0}, {"time": "2020-07-06 16:31:00", "open": 88.8094, "high": 88.8607, "low": 88.7573, "close": 88.7573, "volume": 603780.0}, {"time": "2020-07-06 16:32:00", "open": 88.7768, "high": 88.7768, "low": 88.5753, "close": 88.6307, "volume": 358575.0}, {"time": "2020-07-06 16:33:00", "open": 88.649, "high": 88.7355, "low": 88.6, "close": 88.6207, "volume": 238320.0}, {"time": "2020-07-06 16:34:00", "open": 88.6207, "high": 88.6207, "low": 88.4393, "close": 88.5168, "volume": 352530.0}, {"time": "2020-07-06 16:35:00", "open": 88.4507, "high": 88.6025, "low": 88.4507, "close": 88.5507, "volume": 238785.0}, {"time": "2020-07-06 16:36:00", "open": 88.5887, "high": 88.6667, "low": 88.5754, "close": 88.6353, "volume": 342270.0}, {"time": "2020-07-06 16:37:00", "open": 88.63, "high": 88.7367, "low": 88.5988, "close": 88.7113, "volume": 382680.0}, {"time": "2020-07-06 16:38:00", "open": 88.678, "high": 88.7007, "low": 88.5467, "close": 88.6127, "volume": 895755.0}, {"time": "2020-07-06 16:39:00", "open": 88.5923, "high": 88.6767, "low": 88.5687, "close": 88.6407, "volume": 191625.0}, {"time": "2020-07-06 16:40:00", "open": 88.661, "high": 88.661, "low": 88.5333, "close": 88.6153, "volume": 197895.0}];
    const markersData = [{"time": "2020-07-06 13:31:00", "position": "aboveBar", "color": "#2196F3", "shape": "arrowDown", "text": "Pole Start 13:31"}, {"time": "2020-07-06 14:03:00", "position": "belowBar", "color": "#FF9800", "shape": "arrowUp", "text": "Pole End 32.0min 14:03"}, {"time": "2020-07-06 14:25:00", "position": "aboveBar", "color": "#9C27B0", "shape": "square", "text": "Convergence End 14:25"}, {"time": "2020-07-06 15:00:00", "position": "aboveBar", "color": "#4CAF50", "shape": "circle", "text": "End of Flagpole  15:00"}];
    const timingInfo = {"start": "2020-07-06 13:31:00", "end": "2020-07-06 15:00:00", "analysisEnd": "2020-07-06 15:40:00", "convergence": "2020-07-06 14:25:00"};
    const forwardTestData = null;
    
    // Helper functions
    const dateToTimestamp = (dateStr) => {
        const [datePart, timePart] = dateStr.split(' ');
        const [year, month, day] = datePart.split('-').map(Number);
        const [hour, minute, second] = timePart.split(':').map(Number);
        const utcDate = new Date(Date.UTC(year, month - 1, day, hour, minute, second));
        return Math.floor(utcDate.getTime() / 1000);
    };
    
    const formatTime = (timestamp) => {
        const date = new Date(timestamp * 1000);
        const hours = String(date.getUTCHours()).padStart(2, '0');
        const minutes = String(date.getUTCMinutes()).padStart(2, '0');
        return `${hours}:${minutes}`;
    };
    
    const formatDate = (timestamp) => {
        const date = new Date(timestamp * 1000);
        const year = date.getUTCFullYear();
        const month = String(date.getUTCMonth() + 1).padStart(2, '0');
        const day = String(date.getUTCDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
    };
    
    // Wait for DOM and library
    const initChart = () => {
        const chartElement = document.getElementById('chart');
        
        if (!chartElement) {
            console.error('Chart element not found');
            return;
        }
        
        if (typeof window.LightweightCharts === 'undefined') {
            console.error('LightweightCharts library not loaded');
            chartElement.innerHTML = '<p style="color: red; padding: 20px;">Error: Chart library not loaded. Please refresh the page.</p>';
            return;
        }
        
        // Create chart with proper sizing
        const containerWidth = chartElement.offsetWidth || 800;
        chartOptions.width = containerWidth;
        
        // Height is already properly configured by chart layout system
        // No need to override here
        
        const chart = window.LightweightCharts.createChart(chartElement, chartOptions);
        
        // Custom time formatting for axis
        chart.applyOptions({
            timeScale: {
                tickMarkFormatter: (time, tickMarkType) => {
                    const date = new Date(time * 1000);
                    
                    // Different formats based on zoom level
                    switch(tickMarkType) {
                        case 0: // Year
                            return date.getUTCFullYear().toString();
                        case 1: // Month
                            return formatDate(time).substring(0, 7);
                        case 2: // Day
                            return formatDate(time).substring(5);
                        default: // Time
                            return formatTime(time);
                    }
                },
            },
            localization: {
                timeFormatter: (timestamp) => {
                    return `${formatDate(timestamp)} ${formatTime(timestamp)} UTC`;
                },
            },
        });
        
        // Create candlestick series
        const candlestickSeries = chart.addCandlestickSeries({"upColor": "#00D4A3", "downColor": "#FF4757", "borderVisible": false, "wickUpColor": "#00D4A3", "wickDownColor": "#FF4757", "wickVisible": true});
        
        // Set data
        const formattedData = candlestickData.map(d => ({
            time: dateToTimestamp(d.time),
            open: d.open,
            high: d.high,
            low: d.low,
            close: d.close,
        }));
        
        candlestickSeries.setData(formattedData);
        
        // Add markers with enhanced visibility
        if (markersData.length > 0) {
            const formattedMarkers = markersData.map(m => ({
                time: dateToTimestamp(m.time),
                position: m.position,
                color: m.color,
                shape: m.shape,
                text: m.text,
                size: 2,  // Larger marker size
            }));
            
            candlestickSeries.setMarkers(formattedMarkers);
            
            // Apply custom styling for marker text
            chart.applyOptions({
                layout: {
                    fontSize: 16,  // Increase marker text font size
                },
            });
        }
        
        // Add flagpole zone
        
        // Create flagpole zone
        if (timingInfo.start && timingInfo.end) {
            const flagpoleAreaSeries = chart.addAreaSeries({
                topColor: 'rgba(0, 212, 163, 0.4)',
                bottomColor: 'rgba(0, 212, 163, 0.15)',
                lineColor: 'rgba(0, 212, 163, 0.8)',
                lineWidth: 2,
                crosshairMarkerVisible: false,
                priceLineVisible: false,
            });
            
            // Get data for flagpole period
            const startTime = dateToTimestamp(timingInfo.start);
            const endTime = dateToTimestamp(timingInfo.end);
            const flagpoleData = formattedData.filter(d => d.time >= startTime && d.time <= endTime);
            
            if (flagpoleData.length > 0) {
                const maxPrice = Math.max(...flagpoleData.map(d => d.high));
                const areaData = flagpoleData.map(d => ({
                    time: d.time,
                    value: maxPrice * 1.02,
                }));
                flagpoleAreaSeries.setData(areaData);
            }
        }
        
        // Create analysis window zone
        if (timingInfo.analysisEnd) {
            const analysisAreaSeries = chart.addAreaSeries({
                topColor: 'rgba(0, 212, 163, 0.25)',
                bottomColor: 'rgba(0, 212, 163, 0.08)',
                lineColor: 'rgba(0, 212, 163, 0.5)',
                lineWidth: 1,
                crosshairMarkerVisible: false,
                priceLineVisible: false,
            });
            
            // Get data for analysis period
            const endTime = dateToTimestamp(timingInfo.end);
            const analysisEndTime = dateToTimestamp(timingInfo.analysisEnd);
            const analysisData = formattedData.filter(d => d.time >= endTime && d.time <= analysisEndTime);
            
            if (analysisData.length > 0) {
                const maxPrice = Math.max(...analysisData.map(d => d.high));
                const areaData = analysisData.map(d => ({
                    time: d.time,
                    value: maxPrice * 1.02,
                }));
                analysisAreaSeries.setData(areaData);
            }
        }
        
        
        // Add legend if forward test data available
        
        // Create legend for forward test data
        if (forwardTestData) {
            const legend = document.createElement('div');
            legend.style.cssText = `
            position: absolute;
            left: 16px;
            top: 16px;
            background: rgba(11, 20, 38, 0.95);
            padding: 16px;
            border-radius: 8px;
            font-size: 11px;
            font-family: 'JetBrains Mono', 'SF Mono', 'Monaco', 'Consolas', monospace;
            font-weight: 500;
            color: #F8FAFC;
            border: 1px solid #334155;
            z-index: 1000;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3), 0 0 20px rgba(0, 212, 163, 0.1);
        `;
            
            const isProfitable = forwardTestData.forwardReturn > 0;
            const signalColor = forwardTestData.signalType === 'BUY' ? 
                '#00D4A3' : '#FF4757';
            const returnColor = isProfitable ? 
                '#00D4A3' : '#FF4757';
            
            legend.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 6px; color: #333;">Forward Test Results</div>
                <div style="margin-bottom: 4px;">Signal: <span style="color: ${signalColor};font-weight:bold;">${forwardTestData.signalType}</span></div>
                <div style="margin-bottom: 4px;">Entry: <span style="font-weight:bold;">$${forwardTestData.entryPrice.toFixed(2)}</span></div>
                <div style="margin-bottom: 4px;">Exit: <span style="font-weight:bold;">$${forwardTestData.exitPrice.toFixed(2)}</span></div>
                <div style="margin-bottom: 4px;">Return: <span style="color: ${returnColor};font-weight:bold;">${(forwardTestData.forwardReturn * 100).toFixed(2)}%</span></div>
                <div>Window: <span style="font-weight:bold;">${forwardTestData.analysisWindow} minutes</span></div>
            `;
            
            chartElement.appendChild(legend);
        }
        
        
        // Add info box with flagpole details
        
        // Create info box with flagpole details
        const createInfoBox = () => {
            const infoBox = document.createElement('div');
            infoBox.id = 'flagpole-info-box';
            infoBox.style.cssText = `
                position: absolute;
                left: 16px;
                top: 16px;
                background: rgba(11, 20, 38, 0.95);
                padding: 16px;
                border-radius: 8px;
                font-size: 13px;
                font-family: 'JetBrains Mono', 'SF Mono', 'Monaco', 'Consolas', monospace;
                font-weight: 500;
                color: #F8FAFC;
                border: 1px solid #334155;
                z-index: 1000;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3), 0 0 20px rgba(0, 212, 163, 0.1);
                min-width: 280px;
            `;
            
            // Get pole start and end times/prices from markers
            let poleStartPrice = 'N/A';
            let poleEndPrice = 'N/A';
            let convergencePrice = 'N/A';
            let entryPrice = 'N/A';
            let exitPrice = 'N/A';
            let orderType = 'N/A';
            
            // Find prices from markers
            if (markersData && markersData.length > 0) {
                markersData.forEach(marker => {
                    if (marker.text.includes('Pole Start')) {
                        // Get price from candlestick data at this time
                        const markerTime = dateToTimestamp(marker.time);
                        const candle = formattedData.find(d => Math.abs(d.time - markerTime) < 60);
                        if (candle) poleStartPrice = '$' + candle.close.toFixed(2);
                    }
                    if (marker.text.includes('Pole End')) {
                        const markerTime = dateToTimestamp(marker.time);
                        const candle = formattedData.find(d => Math.abs(d.time - markerTime) < 60);
                        if (candle) poleEndPrice = '$' + candle.close.toFixed(2);
                    }
                    if (marker.text.includes('Convergence End')) {
                        const markerTime = dateToTimestamp(marker.time);
                        const candle = formattedData.find(d => Math.abs(d.time - markerTime) < 60);
                        if (candle) convergencePrice = '$' + candle.close.toFixed(2);
                    }
                    if (marker.text.includes('Entry:')) {
                        const match = marker.text.match(/\$([0-9.]+)/);
                        if (match) entryPrice = '$' + match[1];
                        // Extract order type
                        if (marker.text.includes('BUY')) orderType = 'BUY';
                        else if (marker.text.includes('SHORT')) orderType = 'SHORT';
                        else if (marker.text.includes('NEUTRAL')) orderType = 'NEUTRAL';
                    }
                    if (marker.text.includes('Exit:')) {
                        const match = marker.text.match(/\$([0-9.]+)/);
                        if (match) exitPrice = '$' + match[1];
                    }
                });
            }
            
            // Use forward test data if available
            if (forwardTestData) {
                entryPrice = '$' + forwardTestData.entryPrice.toFixed(2);
                exitPrice = '$' + forwardTestData.exitPrice.toFixed(2);
                orderType = forwardTestData.signalType || orderType;
            }
            
            infoBox.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 12px; color: #00D4A3; font-size: 14px;">
                    Flagpole Information
                </div>
                <div style="display: grid; grid-template-columns: auto 1fr; gap: 8px 16px;">
                    <div style="color: #94A3B8;">Pole Start:</div>
                    <div style="color: #F8FAFC;">
                        <span style="font-weight: bold;">${timingInfo.start ? formatTime(dateToTimestamp(timingInfo.start)) : 'N/A'}</span>
                        <span style="color: #0EA5E9; margin-left: 8px;">${poleStartPrice}</span>
                    </div>
                    
                    <div style="color: #94A3B8;">Pole End:</div>
                    <div style="color: #F8FAFC;">
                        <span style="font-weight: bold;">${timingInfo.end ? formatTime(dateToTimestamp(timingInfo.end)) : 'N/A'}</span>
                        <span style="color: #0EA5E9; margin-left: 8px;">${poleEndPrice}</span>
                    </div>
                    
                    ${timingInfo.convergence ? `
                    <div style="color: #94A3B8;">Convergence End:</div>
                    <div style="color: #F8FAFC;">
                        <span style="font-weight: bold;">${formatTime(dateToTimestamp(timingInfo.convergence))}</span>
                        <span style="color: #9C27B0; margin-left: 8px;">${convergencePrice}</span>
                    </div>
                    ` : ''}
                    
                    <div style="color: #94A3B8; margin-top: 8px;">Entry:</div>
                    <div style="color: #F8FAFC; margin-top: 8px;">
                        <span style="font-weight: bold; color: #00D4A3;">${entryPrice}</span>
                        <span style="color: #FFC107; margin-left: 12px; font-weight: bold;">${orderType}</span>
                    </div>
                    
                    <div style="color: #94A3B8;">Exit:</div>
                    <div style="color: #F8FAFC;">
                        <span style="font-weight: bold; color: #FF4757;">${exitPrice}</span>
                    </div>
                </div>
            `;
            
            chartElement.appendChild(infoBox);
        };
        
        createInfoBox();
        
        
        // Handle window resize
        const handleResize = () => {
            const newWidth = chartElement.offsetWidth || 800;
            chart.applyOptions({ width: newWidth });
        };
        
        window.addEventListener('resize', handleResize);
        
        // Fit content and ensure time axis is visible
        chart.timeScale().fitContent();
        
        // Force time scale visibility
        chart.timeScale().applyOptions({
            visible: true,
            borderVisible: true,
            ticksVisible: true,
        });
        
        // Store chart instance for debugging
        window.chartInstance = chart;
        
        console.log('Chart initialized successfully');
    };
    
    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initChart);
    } else {
        initChart();
    }
})();
</script>

        </div>
    </div>
</body>
</html>