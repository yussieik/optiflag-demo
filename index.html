<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OptiFlag - Advanced Trading Pattern Recognition System</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/styles.css">
    <script>
    // Optimization simulation logic
    window.onload = function() {
        const steps = [
            { text: "Initializing Bayesian Optimizer...", progress: 10 },
            { text: "Loading TSLA market data (2 years)...", progress: 20 },
            { text: "Detecting flagpole patterns...", progress: 35 },
            { text: "Optimizing parameters (Generation 1/10)...", progress: 45 },
            { text: "Evaluating fitness scores...", progress: 55 },
            { text: "Optimizing parameters (Generation 5/10)...", progress: 65 },
            { text: "Convergence detected...", progress: 80 },
            { text: "Validating on forward test data...", progress: 90 },
            { text: "Optimization complete!", progress: 100 }
        ];
        
        let currentStep = 0;
        const statusText = document.getElementById('status-text');
        const progressBar = document.getElementById('progress-fill');
        const metricsContainer = document.getElementById('metrics-container');
        const patternViz = document.getElementById('pattern-viz');
        
        // Generate random pattern visualization
        function generatePatternBars() {
            const bars = [];
            for (let i = 0; i < 50; i++) {
                const height = Math.random() * 80 + 20;
                const isHighlight = Math.random() > 0.85;
                bars.push(`<div class="pattern-bar ${isHighlight ? 'highlight' : ''}" style="height: ${height}%"></div>`);
            }
            return bars.join('');
        }
        
        patternViz.innerHTML = generatePatternBars();
        
        // Animate optimization process
        function animateStep() {
            if (currentStep < steps.length) {
                const step = steps[currentStep];
                statusText.textContent = step.text;
                progressBar.style.width = step.progress + '%';
                
                // Update metrics randomly during optimization
                if (currentStep > 2 && currentStep < steps.length - 1) {
                    updateMetrics();
                }
                
                // Regenerate pattern visualization occasionally
                if (currentStep % 3 === 0) {
                    patternViz.innerHTML = generatePatternBars();
                }
                
                currentStep++;
                setTimeout(animateStep, 600);
            } else {
                // Show final metrics
                showFinalMetrics();
                // Redirect after a brief pause
                setTimeout(() => {
                    document.getElementById('intro-container').classList.add('fade-out');
                    setTimeout(() => {
                        window.location.href = 'main.html';
                    }, 500);
                }, 1500);
            }
        }
        
        function updateMetrics() {
            const patterns = Math.floor(Math.random() * 50) + 100;
            const score = (Math.random() * 0.3 + 0.7).toFixed(3);
            const winRate = (Math.random() * 20 + 60).toFixed(1);
            
            document.getElementById('patterns-found').textContent = patterns;
            document.getElementById('optimization-score').textContent = score;
            document.getElementById('win-rate').textContent = winRate + '%';
        }
        
        function showFinalMetrics() {
            document.getElementById('patterns-found').textContent = '147';
            document.getElementById('optimization-score').textContent = '0.924';
            document.getElementById('win-rate').textContent = '78.3%';
            metricsContainer.classList.add('highlight-final');
        }
        
        // Start animation
        setTimeout(animateStep, 500);
    };
    </script>
</head>
<body class="intro-body">
    <div id="intro-container" class="intro-container">
        <div class="intro-header">
            <h1 class="intro-title">OptiFlag</h1>
            <p class="intro-subtitle">Advanced Trading Pattern Recognition System</p>
        </div>
        
        <div class="optimization-container">
            <div class="optimization-header">
                <h2>Running Bayesian Optimization</h2>
                <div class="ticker-badge">TSLA</div>
            </div>
            
            <div class="pattern-visualization" id="pattern-viz"></div>
            
            <div class="progress-container">
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
                <p id="status-text" class="status-text">Initializing...</p>
            </div>
            
            <div id="metrics-container" class="metrics-grid intro-metrics">
                <div class="metric-box">
                    <span class="metric-label">Patterns Found</span>
                    <span id="patterns-found" class="metric-value">0</span>
                </div>
                <div class="metric-box">
                    <span class="metric-label">Optimization Score</span>
                    <span id="optimization-score" class="metric-value">0.000</span>
                </div>
                <div class="metric-box">
                    <span class="metric-label">Win Rate</span>
                    <span id="win-rate" class="metric-value">0.0%</span>
                </div>
            </div>
            
            <div class="algorithm-info">
                <p>Using Gaussian Process with Expected Improvement acquisition function</p>
                <p class="tech-stack">Powered by scikit-optimize • Python 3.13 • Async Architecture</p>
            </div>
        </div>
    </div>
</body>
</html>